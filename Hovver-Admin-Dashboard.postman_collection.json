{
	"info": {
		"_postman_id": "hovver-admin-dashboard-collection",
		"name": "Hovver Admin Dashboard API",
		"description": "Complete API collection for testing the Hovver Admin Dashboard backend with AWS Cognito authentication, role-based access control, customer management, S3 image management, and automated email notifications via AWS SES.\\n\\n**Email Features:**\\n- Automatic welcome emails when customers are created (noreply@samwylock.com)\\n- Resend welcome emails with new temporary passwords\\n- Professional HTML email templates\\n- Verified domain: samwylock.com\\n\\n**Key Features:**\\n- JWT-based authentication with Cognito\\n- Role-based access (Admin, Customer)\\n- Customer profile management\\n- Organized S3 storage (customer-specific folders)\\n- Image upload and management\\n- Presigned URL generation for secure file access",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{access_token}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "base_url",
			"value": "https://api.samwylock.com",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "id_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "refresh_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "username",
			"value": "sjw787.sw@gmail.com",
			"type": "string"
		},
		{
			"key": "password",
			"value": "",
			"type": "string"
		},
		{
			"key": "customer_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "last_uploaded_image_key",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Health Check",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Response has status field\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData).to.have.property('status');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/",
					"host": [
						"{{base_url}}"
					],
					"path": [
						""
					]
				},
				"description": "Health check endpoint to verify the API is running."
			},
			"response": []
		},
		{
			"name": "CORS Test",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Response has CORS info\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData).to.have.property('message');",
							"    pm.expect(jsonData).to.have.property('allowed_origins');",
							"    pm.expect(jsonData.message).to.equal('CORS is working!');",
							"});",
							"",
							"pm.test(\"CORS headers are present\", function () {",
							"    pm.response.to.have.header('Access-Control-Allow-Origin');",
							"    pm.response.to.have.header('Access-Control-Allow-Credentials');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/cors-test",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"cors-test"
					]
				},
				"description": "Test CORS configuration. Returns information about allowed origins and CORS settings."
			},
			"response": []
		},
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has access_token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('access_token');",
									"    pm.expect(jsonData).to.have.property('id_token');",
									"    pm.expect(jsonData).to.have.property('refresh_token');",
									"    ",
									"    // Save tokens to collection variables",
									"    pm.collectionVariables.set(\"access_token\", jsonData.access_token);",
									"    pm.collectionVariables.set(\"id_token\", jsonData.id_token);",
									"    pm.collectionVariables.set(\"refresh_token\", jsonData.refresh_token);",
									"});",
									"",
									"pm.test(\"Token type is Bearer\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.token_type).to.eql('Bearer');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"{{username}}\",\n    \"password\": \"{{password}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Login with username and password. Returns JWT access token, ID token, and refresh token. The access token is automatically saved to collection variables for use in authenticated requests."
					},
					"response": []
				},
				{
					"name": "Get Current User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has user information\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('username');",
									"    pm.expect(jsonData).to.have.property('email');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/auth/me",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"me"
							]
						},
						"description": "Get the current authenticated user's information. Requires valid access token in Authorization header."
					},
					"response": []
				},
				{
					"name": "Change Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Password changed successfully\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('successfully');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"old_password\": \"CurrentPassword123!\",\n    \"new_password\": \"NewPassword456!\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/change-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"change-password"
							]
						},
						"description": "Change the authenticated user's password. Requires current password and new password. Must be authenticated with valid access token."
					},
					"response": []
				},
				{
					"name": "Forgot Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response contains message\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('code');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"{{username}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/forgot-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"forgot-password"
							]
						},
						"description": "Initiate forgot password flow. Sends a confirmation code to the user's email. No authentication required - public endpoint."
					},
					"response": []
				},
				{
					"name": "Reset Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Password reset successfully\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('successfully');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"{{username}}\",\n    \"confirmation_code\": \"123456\",\n    \"new_password\": \"NewPassword456!\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/reset-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"reset-password"
							]
						},
						"description": "Complete forgot password flow with confirmation code from email. No authentication required."
					},
					"response": []
				},
				{
					"name": "Complete New Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has access_token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('access_token');",
									"    pm.expect(jsonData).to.have.property('id_token');",
									"    pm.expect(jsonData).to.have.property('refresh_token');",
									"    ",
									"    // Save tokens to collection variables",
									"    pm.collectionVariables.set(\"access_token\", jsonData.access_token);",
									"    pm.collectionVariables.set(\"id_token\", jsonData.id_token);",
									"    pm.collectionVariables.set(\"refresh_token\", jsonData.refresh_token);",
									"});",
									"",
									"pm.test(\"Token type is Bearer\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.token_type).to.eql('Bearer');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"{{username}}\",\n    \"temporary_password\": \"TEMP_PASSWORD_HERE\",\n    \"new_password\": \"NewPassword456!\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/complete-new-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"complete-new-password"
							]
						},
						"description": "Complete NEW_PASSWORD_REQUIRED challenge when user has a temporary password. Returns authentication tokens on success. No authentication required - uses temporary password."
					},
					"response": []
				},
				{
					"name": "Refresh Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has new access_token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('access_token');",
									"    pm.expect(jsonData).to.have.property('id_token');",
									"    ",
									"    // Update tokens in collection variables",
									"    pm.collectionVariables.set(\"access_token\", jsonData.access_token);",
									"    pm.collectionVariables.set(\"id_token\", jsonData.id_token);",
									"});",
									"",
									"pm.test(\"Token type is Bearer\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.token_type).to.eql('Bearer');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"refresh_token\": \"{{refresh_token}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/refresh",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"refresh"
							]
						},
						"description": "Refresh access token using refresh token. Returns new access and ID tokens. No authentication header required - uses refresh token in body."
					},
					"response": []
				},
				{
					"name": "Get Detailed User Info",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has user details\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('username');",
									"    pm.expect(jsonData).to.have.property('attributes');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/auth/user-info",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"user-info"
							]
						},
						"description": "Get detailed user information including all Cognito attributes. Requires authentication."
					},
					"response": []
				},
				{
					"name": "Update Profile",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Profile updated successfully\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('updated');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"full_name\": \"Sam Wylock\",\n    \"phone_number\": \"+1234567890\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"profile"
							]
						},
						"description": "Update user profile - full name and phone number. All fields are optional - only include fields you want to update. Phone number must be in E.164 format (+1234567890)."
					},
					"response": []
				}
			],
			"description": "Authentication and user management endpoints for login, password management, and profile updates."
		},
		{
			"name": "User Management",
			"item": [
				{
					"name": "Forgot Password Flow",
					"item": [
						{
							"name": "1. Request Reset Code",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"username\": \"{{username}}\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/auth/forgot-password",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"auth",
										"forgot-password"
									]
								},
								"description": "Step 1: Request password reset code. Check your email for the confirmation code."
							},
							"response": []
						},
						{
							"name": "2. Reset with Code",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"username\": \"{{username}}\",\n    \"confirmation_code\": \"PASTE_CODE_HERE\",\n    \"new_password\": \"NewPassword456!\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/auth/reset-password",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"auth",
										"reset-password"
									]
								},
								"description": "Step 2: Complete password reset with code from email and new password."
							},
							"response": []
						}
					],
					"description": "Complete forgot password workflow in 2 steps."
				}
			],
			"description": "User management workflows and operations."
		},
		{
			"name": "Customer Management (Admin Only)",
			"item": [
				{
					"name": "Create Customer",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has customer_id and all required fields\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customer_id');",
									"    pm.expect(jsonData).to.have.property('email');",
									"    pm.expect(jsonData).to.have.property('name');",
									"    pm.expect(jsonData).to.have.property('customer_folder');",
									"    pm.expect(jsonData).to.have.property('temporary_password');",
									"    ",
									"    // Save customer_id for other requests",
									"    if (jsonData.customer_id) {",
									"        pm.collectionVariables.set(\"customer_id\", jsonData.customer_id);",
									"    }",
									"});",
									"",
									"pm.test(\"Customer folder path is correct\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.customer_folder).to.include('customers/');",
									"});",
									"",
									"pm.test(\"Temporary password is auto-generated\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.temporary_password).to.be.a('string');",
									"    pm.expect(jsonData.temporary_password.length).to.be.at.least(8);",
									"    console.log('Generated temporary password:', jsonData.temporary_password);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"customer@example.com\",\n    \"name\": \"John Doe\",\n    \"phone_number\": \"+12345678900\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/customers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"customers"
							]
						},
						"description": "Create a new customer profile. Admin only. Creates user in Cognito and assigns to Customers group.\\n\\n**Welcome Email:**\\nA welcome email is automatically sent to the customer via AWS SES (noreply@samwylock.com) containing their temporary password and login instructions.\\n\\n**Password:**\\nA secure temporary password is automatically generated (16 characters with uppercase, lowercase, numbers, and special characters). The password is included in both the API response and the welcome email. Customer must change this password on first login.\\n\\n**Required Fields:**\\n- email: Used as the username (required)\\n- name: Customer's full name (required)\\n\\n**Optional Fields:**\\n- phone_number: Must be in E.164 format if provided (e.g., +12025551234)\\n\\n**Email Delivery:**\\nIf email delivery fails, the customer is still created successfully. The temporary password is returned in the API response and can be resent using the /customers/{customer_id}/resend-welcome endpoint."
					},
					"response": []
				},
				{
					"name": "List All Customers",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has customers array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customers');",
									"    pm.expect(jsonData.customers).to.be.an('array');",
									"    pm.expect(jsonData).to.have.property('count');",
									"});",
									"",
									"pm.test(\"Customers have required fields including user_status\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.customers.length > 0) {",
									"        var customer = jsonData.customers[0];",
									"        pm.expect(customer).to.have.property('customer_id');",
									"        pm.expect(customer).to.have.property('email');",
									"        pm.expect(customer).to.have.property('name');",
									"        pm.expect(customer).to.have.property('customer_folder');",
									"        pm.expect(customer).to.have.property('created_date');",
									"        pm.expect(customer).to.have.property('enabled');",
									"        pm.expect(customer).to.have.property('user_status');",
									"        ",
									"        // Log status summary for frontend implementation",
									"        console.log('Customer status:', customer.user_status);",
									"        var canResend = customer.user_status === 'FORCE_CHANGE_PASSWORD' || ",
									"                        customer.user_status === 'RESET_REQUIRED';",
									"        console.log('Show resend button:', canResend);",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/customers?limit=60",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"customers"
							],
							"query": [
								{
									"key": "limit",
									"value": "60",
									"description": "Maximum number of customers to return"
								}
							]
						},
						"description": "List all customer profiles. Admin only. Returns all customers in the Customers group with their details and S3 folder paths."
					},
					"response": []
				},
				{
					"name": "Get Customer by ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has customer details\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customer_id');",
									"    pm.expect(jsonData).to.have.property('email');",
									"    pm.expect(jsonData).to.have.property('name');",
									"    pm.expect(jsonData).to.have.property('customer_folder');",
									"    pm.expect(jsonData).to.have.property('user_status');",
									"    console.log('Customer status:', jsonData.user_status);",
									"});",
									"",
									"pm.test(\"user_status indicates if resend is available\", function () {",
									"    var jsonData = pm.response.json();",
									"    var canResend = jsonData.user_status === 'FORCE_CHANGE_PASSWORD' || ",
									"                    jsonData.user_status === 'RESET_REQUIRED';",
									"    console.log('Can resend welcome email:', canResend);",
									"    ",
									"    if (canResend) {",
									"        console.log('âœ… Frontend should SHOW \"Resend Welcome Email\" button');",
									"    } else {",
									"        console.log('âŒ Frontend should HIDE \"Resend Welcome Email\" button');",
									"        console.log('   Customer should use forgot password flow instead');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/customers/{{customer_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"customers",
								"{{customer_id}}"
							]
						},
						"description": "Get detailed information about a specific customer. Admin only. Returns customer profile including S3 folder path and account status.\\n\\n**Response includes user_status field:**\\n- FORCE_CHANGE_PASSWORD: Customer has temporary password, hasn't logged in yet (resend welcome email available)\\n- CONFIRMED: Customer has completed initial login and set their own password (resend not available, use forgot password)\\n- RESET_REQUIRED: Password reset required\\n- Other statuses: See AWS Cognito documentation\\n\\nFrontend can use user_status to determine if 'Resend Welcome Email' button should be shown. Show button only when user_status is 'FORCE_CHANGE_PASSWORD' or 'RESET_REQUIRED'."
					},
					"response": []
				},
				{
					"name": "Update Customer",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Customer updated successfully\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customer_id');",
									"    pm.expect(jsonData).to.have.property('name');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"John Smith\",\n    \"phone_number\": \"+19876543210\",\n    \"enabled\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/customers/{{customer_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"customers",
								"{{customer_id}}"
							]
						},
						"description": "Update customer profile information. Admin only. All fields are optional - only include fields you want to update. Can enable/disable customer account."
					},
					"response": []
				},
				{
					"name": "Disable Customer Account",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Customer disabled\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.enabled).to.eql(false);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"enabled\": false\n}"
						},
						"url": {
							"raw": "{{base_url}}/customers/{{customer_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"customers",
								"{{customer_id}}"
							]
						},
						"description": "Disable a customer account. Admin only. Disabled customers cannot login."
					},
					"response": []
				},
				{
					"name": "Resend Welcome Email",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// This endpoint can return 200 (success) or 400 (user already set password)",
									"",
									"if (pm.response.code === 200) {",
									"    // Success case - customer had temporary password",
									"    pm.test(\"Status code is 200 - Welcome email resent\", function () {",
									"        pm.response.to.have.status(200);",
									"    });",
									"    ",
									"    pm.test(\"Response has new temporary password\", function () {",
									"        var jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('customer_id');",
									"        pm.expect(jsonData).to.have.property('email');",
									"        pm.expect(jsonData).to.have.property('temporary_password');",
									"        pm.expect(jsonData).to.have.property('message');",
									"        pm.expect(jsonData.temporary_password).to.be.a('string');",
									"        pm.expect(jsonData.temporary_password.length).to.be.at.least(8);",
									"        console.log('âœ… New temporary password:', jsonData.temporary_password);",
									"        console.log('ðŸ“§ Email sent to:', jsonData.email);",
									"    });",
									"    ",
									"    pm.test(\"Success message present\", function () {",
									"        var jsonData = pm.response.json();",
									"        pm.expect(jsonData.message).to.include('resent');",
									"    });",
									"} else if (pm.response.code === 400) {",
									"    // Expected error - customer already set their password",
									"    pm.test(\"Status code is 400 - Customer already set password\", function () {",
									"        pm.response.to.have.status(400);",
									"    });",
									"    ",
									"    pm.test(\"Error message explains restriction\", function () {",
									"        var jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('detail');",
									"        pm.expect(jsonData.detail).to.include('already set their own password');",
									"        console.log('âš ï¸ Cannot resend: Customer already changed their password');",
									"        console.log('ðŸ’¡ Solution: Customer should use forgot password flow');",
									"    });",
									"} else {",
									"    pm.test(\"Unexpected status code\", function () {",
									"        pm.expect.fail('Expected 200 or 400, got ' + pm.response.code);",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/customers/{{customer_id}}/resend-welcome",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"customers",
								"{{customer_id}}",
								"resend-welcome"
							]
						},
						"description": "Resend welcome email with new temporary password. Admin only.\\n\\n**Use cases:**\\n- Customer didn't receive original email\\n- Temporary password expired (after 7 days)\\n- Customer lost/forgot their temporary password\\n- Customer never completed initial login\\n\\n**Important Restriction:**\\nThis endpoint will return a 400 error if the customer has already set their own password (status: CONFIRMED). In that case, the customer should use the standard forgot password flow instead.\\n\\n**Valid for users with status:**\\n- FORCE_CHANGE_PASSWORD (has temporary password)\\n- RESET_REQUIRED (password reset required)\\n\\nGenerates a new temporary password and sends a welcome email to the customer. The password must be changed on first login."
					},
					"response": [
						{
							"name": "Success - Password Resent",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{base_url}}/customers/{{customer_id}}/resend-welcome",
									"host": ["{{base_url}}"],
									"path": ["customers", "{{customer_id}}", "resend-welcome"]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{"key": "Content-Type", "value": "application/json"}
							],
							"cookie": [],
							"body": "{\n    \"customer_id\": \"abc123...\",\n    \"email\": \"customer@example.com\",\n    \"name\": \"John Doe\",\n    \"temporary_password\": \"xY9$nMz2!pQ8wE5t\",\n    \"message\": \"Welcome email resent with new temporary password\"\n}"
						},
						{
							"name": "Error - Customer Already Set Password",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{base_url}}/customers/{{customer_id}}/resend-welcome",
									"host": ["{{base_url}}"],
									"path": ["customers", "{{customer_id}}", "resend-welcome"]
								}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [
								{"key": "Content-Type", "value": "application/json"}
							],
							"cookie": [],
							"body": "{\n    \"detail\": \"Cannot resend welcome email. Customer has already set their own password. Use the forgot password flow instead.\"\n}"
						}
					]
				}
			],
			"description": "Customer management endpoints for admins. Create, list, view, and update customer profiles. Customers are organized with dedicated S3 folders.\\n\\n**Email Integration:**\\n- Welcome emails automatically sent when customers are created\\n- Emails include temporary password and login instructions\\n- Resend capability for expired or lost passwords\\n- Sent via AWS SES from noreply@samwylock.com\\n\\n**Customer Lifecycle:**\\n1. Admin creates customer (POST /customers)\\n2. Welcome email sent automatically with temporary password\\n3. Customer logs in and must change password\\n4. If email not received, admin can resend (POST /customers/{id}/resend-welcome)\\n5. After customer sets password, use forgot password flow for resets"
		},
		{
			"name": "Image Management",
			"item": [
				{
					"name": "Upload Image to Customer Folder (Admin)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has file key\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('key');",
									"    pm.expect(jsonData).to.have.property('customer_id');",
									"    pm.expect(jsonData).to.have.property('folder');",
									"    ",
									"    // Save the image key for deletion tests",
									"    if (jsonData.key) {",
									"        pm.collectionVariables.set(\"last_uploaded_image_key\", jsonData.key);",
									"    }",
									"});",
									"",
									"pm.test(\"Upload was successful and in customer folder\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.eql(true);",
									"    pm.expect(jsonData.folder).to.include('customers/');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": [],
									"description": "Image file to upload"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/images/upload?customer_id={{customer_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"upload"
							],
							"query": [
								{
									"key": "customer_id",
									"value": "{{customer_id}}",
									"description": "Customer ID to upload file for"
								}
							]
						},
						"description": "Upload an image file to a specific customer's S3 folder. Admin only. The file will be stored in customers/{customer_id}/YYYY/MM/DD/. Supports common image formats (JPG, JPEG, PNG, GIF, WebP). Maximum file size: 10MB."
					},
					"response": []
				},
				{
					"name": "Upload Image to General Folder (Admin)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has file key\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('key');",
									"    pm.expect(jsonData).to.have.property('folder');",
									"    ",
									"    // Save the image key for deletion tests",
									"    if (jsonData.key) {",
									"        pm.collectionVariables.set(\"last_uploaded_image_key\", jsonData.key);",
									"    }",
									"});",
									"",
									"pm.test(\"Upload was successful and in general folder\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.eql(true);",
									"    pm.expect(jsonData.folder).to.eql('general');",
									"    pm.expect(jsonData.customer_id).to.be.null;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": [],
									"description": "Image file to upload"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/images/upload",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"upload"
							]
						},
						"description": "Upload an image file to the general folder accessible by all customers. Admin only. The file will be stored in general/YYYY/MM/DD/. Supports common image formats (JPG, JPEG, PNG, GIF, WebP). Maximum file size: 10MB."
					},
					"response": []
				},
				{
					"name": "Upload Image (Will Fail for Customer)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 403 for customer\", function () {",
									"    pm.response.to.have.status(403);",
									"});",
									"",
									"pm.test(\"Error message indicates customer cannot upload\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.detail).to.include('Customers cannot upload');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": []
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/images/upload",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"upload"
							]
						},
						"description": "Test endpoint to verify customers cannot upload files. Should return 403 Forbidden when using customer access token."
					},
					"response": []
				},
				{
					"name": "List All Images (Admin View)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has images array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('images');",
									"    pm.expect(jsonData.images).to.be.an('array');",
									"    pm.expect(jsonData).to.have.property('count');",
									"});",
									"",
									"pm.test(\"Images have required fields\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.images.length > 0) {",
									"        var image = jsonData.images[0];",
									"        pm.expect(image).to.have.property('key');",
									"        pm.expect(image).to.have.property('presigned_url');",
									"        pm.expect(image).to.have.property('size');",
									"        pm.expect(image).to.have.property('last_modified');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/list",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"list"
							]
						},
						"description": "List all images across all customers and general folder. Admin only - admins see all files. Returns presigned URLs valid for 1 hour."
					},
					"response": []
				},
				{
					"name": "List Images (Customer View)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has images array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('images');",
									"    pm.expect(jsonData.images).to.be.an('array');",
									"    pm.expect(jsonData).to.have.property('count');",
									"});",
									"",
									"pm.test(\"Customer only sees their files and general files\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.images.length > 0) {",
									"        jsonData.images.forEach(function(image) {",
									"            var isCustomerFile = image.key.includes('customers/');",
									"            var isGeneralFile = image.key.includes('general/');",
									"            pm.expect(isCustomerFile || isGeneralFile).to.be.true;",
									"        });",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/list",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"list"
							]
						},
						"description": "List images for customer. Customer view - only shows files in their own folder plus general folder files. Returns presigned URLs valid for 1 hour."
					},
					"response": []
				},
				{
					"name": "List Images with Prefix (Admin)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has images array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('images');",
									"    pm.expect(jsonData.images).to.be.an('array');",
									"});",
									"",
									"pm.test(\"All images match prefix\", function () {",
									"    var jsonData = pm.response.json();",
									"    var prefix = pm.request.url.query.get('prefix');",
									"    if (jsonData.images.length > 0 && prefix) {",
									"        jsonData.images.forEach(function(image) {",
									"            pm.expect(image.key).to.include(prefix);",
									"        });",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/list?prefix=customers/{{customer_id}}/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"list"
							],
							"query": [
								{
									"key": "prefix",
									"value": "customers/{{customer_id}}/",
									"description": "Filter images by prefix (admin only)"
								}
							]
						},
						"description": "List images filtered by prefix. Admin only. Useful for viewing files for a specific customer or date folder. Prefix parameter is ignored for customer users."
					},
					"response": []
				},
				{
					"name": "List General Folder Images",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"All images are from general folder\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.images.length > 0) {",
									"        jsonData.images.forEach(function(image) {",
									"            pm.expect(image.key).to.include('general/');",
									"        });",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/list?prefix=general/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"list"
							],
							"query": [
								{
									"key": "prefix",
									"value": "general/",
									"description": "Filter to show only general folder images"
								}
							]
						},
						"description": "List only general folder images. Admin only - shows all files in the general folder accessible by all customers."
					},
					"response": []
				},
				{
					"name": "Delete Image (Admin Only)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Deletion was successful\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('deleted successfully');",
									"    pm.expect(jsonData.success).to.eql(true);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/customers/{{customer_id}}/2026/01/16/image_20260116_120000.jpg",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"customers",
								"{{customer_id}}",
								"2026",
								"01",
								"16",
								"image_20260116_120000.jpg"
							]
						},
						"description": "Delete an image from S3 by its key. Admin only. Customers cannot delete files. The key includes the full path (e.g., 'customers/{customer_id}/2026/01/16/image.jpg' or 'general/2026/01/16/image.jpg')."
					},
					"response": []
				},
				{
					"name": "Delete Last Uploaded Image",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Deletion was successful\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('deleted successfully');",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Check if we have a saved image key",
									"var imageKey = pm.collectionVariables.get(\"last_uploaded_image_key\");",
									"if (!imageKey) {",
									"    console.log(\"No image key found. Please upload an image first.\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/{{last_uploaded_image_key}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"{{last_uploaded_image_key}}"
							]
						},
						"description": "Delete the last uploaded image using the saved image key from the upload request. Admin only. This request uses the collection variable 'last_uploaded_image_key' which is automatically set when you upload an image."
					},
					"response": []
				},
				{
					"name": "Delete Image (Will Fail for Customer)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 403 for customer\", function () {",
									"    pm.response.to.have.status(403);",
									"});",
									"",
									"pm.test(\"Error message indicates admin access required\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.detail).to.include('Admin access required');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/images/general/2026/01/16/test.jpg",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"images",
								"general",
								"2026",
								"01",
								"16",
								"test.jpg"
							]
						},
						"description": "Test endpoint to verify customers cannot delete files. Should return 403 Forbidden when using customer access token."
					},
					"response": []
				}
			],
			"description": "Endpoints for managing images in S3 bucket. Admins can upload to customer folders or general folder, list all files, and delete files. Customers can only view their own files and general files."
		},
		{
			"name": "API Documentation",
			"item": [
				{
					"name": "OpenAPI Schema",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/openapi.json",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"openapi.json"
							]
						},
						"description": "Get the OpenAPI (Swagger) schema for the API."
					},
					"response": []
				}
			],
			"description": "API documentation and schema endpoints."
		}
	]
}

