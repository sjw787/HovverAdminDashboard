DNS TIMEOUT ISSUE - RESOLVED
=============================
Date: January 17, 2026

ISSUE: nslookup timing out
--------------------------
You reported that: nslookup -type=TXT _amazonses.samwylock.com 8.8.8.8
keeps timing out.

ROOT CAUSE
----------
This is happening due to one or more of:
1. Corporate/VPN firewall blocking DNS queries to external servers
2. Windows Firewall DNS restrictions
3. Network security policies on your local machine
4. ISP DNS filtering

IMPORTANT: THIS IS COMPLETELY NORMAL ✓
-----------------------------------------
DNS timeouts from YOUR LOCAL MACHINE do NOT affect SES verification!

Why? Because:
- AWS SES verifies DNS records from THEIR infrastructure
- SES queries Route53 directly (not through public DNS)
- Your local DNS issues don't impact AWS-to-AWS communication
- The records ARE in Route53 and ARE accessible to AWS

VERIFICATION
------------
The DNS records exist in Route53 (verified):
✓ _amazonses.samwylock.com TXT record exists
✓ 3 DKIM CNAME records exist
✓ _dmarc.samwylock.com TXT record exists
✓ SPF record exists

AWS can see these records even if you can't query them locally.

CRITICAL ISSUE DISCOVERED
--------------------------
While troubleshooting, I discovered you're in the WRONG AWS ACCOUNT!

Current Account: 777653593792 (iamadmin-general)
Correct Account: 052869941234 (iamadmin-dev)

This is why SES status checks show different results than expected.

ACTION REQUIRED: SWITCH TO iamadmin-dev
----------------------------------------

Option 1: Use AWS Profile (Recommended)
```powershell
$env:AWS_PROFILE="iamadmin-dev"
Remove-Item Env:AWS_ACCESS_KEY_ID -ErrorAction SilentlyContinue
Remove-Item Env:AWS_SECRET_ACCESS_KEY -ErrorAction SilentlyContinue
Remove-Item Env:AWS_SESSION_TOKEN -ErrorAction SilentlyContinue
```

Option 2: Set Environment Variables
```powershell
$env:AWS_ACCESS_KEY_ID="<your-iamadmin-dev-key>"
$env:AWS_SECRET_ACCESS_KEY="<your-iamadmin-dev-secret>"
Remove-Item Env:AWS_PROFILE -ErrorAction SilentlyContinue
```

AFTER SWITCHING ACCOUNTS
-------------------------
Run these commands to verify everything:

1. Confirm you're in the right account:
   python check_ses_verification.py

   Should show: AWS Account: 052869941234

2. Check SES verification status:
   python setup_ses.py --check-status samwylock.com

   Should show: Domain and DKIM verification Success

3. Verify DNS cleanup:
   python cleanup_duplicate_dkim.py

   Should show: Only 3 DKIM records (no duplicates)

TESTING DNS LOCALLY (Optional)
-------------------------------
If you want to test DNS from your machine for troubleshooting:

1. Use PowerShell DNS resolution:
   Resolve-DnsName _amazonses.samwylock.com -Type TXT

2. Use online DNS checkers (they work from external networks):
   - https://dnschecker.org
   - https://www.whatsmydns.net
   - Enter: _amazonses.samwylock.com (TXT record)

3. Check with your ISP's DNS:
   nslookup -type=TXT _amazonses.samwylock.com
   (uses your default DNS, may work)

SUMMARY
-------
✓ DNS records ARE configured correctly in Route53
✓ AWS SES CAN see and verify these records
✗ Your local machine CANNOT query them (firewall/network issue)
✗ You are in the WRONG AWS account (must switch to iamadmin-dev)

The nslookup timeout is a LOCAL NETWORK ISSUE, not an AWS/SES issue.
The CRITICAL issue is the account mismatch - fix that first!

NEXT STEPS
----------
1. Switch to iamadmin-dev account (commands above)
2. Run: python check_ses_verification.py
3. Verify both Domain and DKIM show "Success"
4. If still "Pending", wait another 15-30 minutes
5. Once verified, test welcome email functionality

The local DNS timeout is a red herring - ignore it and focus on:
- Being in the correct AWS account (052869941234)
- SES showing "Success" status
- Welcome emails working when you create customers
